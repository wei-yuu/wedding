import{d as b,K as k,o as p,c as _,A as m,t as v,h as x,r as d,a as o,k as G,G as V,L as q,f as h,w as A,m as E,s as j,n as w,F as B,g as D,u as L,z as C,x as M,M as T}from"./index-64e7db9f.js";import{g as $}from"./get.api-5344152b.js";import{u as F}from"./use-api-call-8c513bff.js";const N={class:"w-full min-h-12 text-3xl"},K={key:0},P={key:1,class:"text-red-400 whitespace-pre"},S=b({__name:"message",setup(i){const t=k("seat"),a=k("notFound");return(n,c)=>{var e;return p(),_("div",N,[m(t)?(p(),_("p",K,"您的座位在： "+v((e=m(t))==null?void 0:e.table),1)):x("",!0),m(a)?(p(),_("p",P,v(`找不到啦(／‵Д′)／~ ╧╧！
請您再確認輸入的姓名`))):x("",!0)])}}}),z={class:"min-w-[40%] flex flex-col justify-center items-center gap-16"},J=o("h2",{class:"text-5xl"},"查詢你的座位",-1),X={class:"w-full flex flex-col"},Z=o("label",{class:"text-2xl w-full"},"你的姓名：",-1),U={class:"w-full grid grid-cols-7 gap-4"},H=b({__name:"query",emits:["click"],setup(i){const t=d("");return(a,n)=>{const c=j,e=S;return p(),_("div",z,[J,o("div",X,[Z,o("div",U,[G(o("input",{type:"text",class:"col-span-5",placeholder:"請輸入完整的姓名","onUpdate:modelValue":n[0]||(n[0]=s=>t.value=s),onKeypress:n[1]||(n[1]=q(s=>a.$emit("click",t.value),["enter"]))},null,544),[[V,t.value]]),h(c,{class:"col-span-2",color:"blue",onClick:n[2]||(n[2]=s=>a.$emit("click",t.value))},{default:A(()=>[E(" 搜尋 ")]),_:1})])]),h(e,{class:"hidden md:block"})])}}}),O={class:"grid gap-4 place-content-center"},Q=o("div",{class:"w-64 h-16 flex justify-center items-center text-4xl border border-black"}," 活動舞台 ",-1),R=o("p",{class:"text-2xl"},"主桌",-1),W={class:"grid grid-cols-3 gap-2 place-content-center grid-flow-dense"},Y={class:"text-xl"},ee=b({__name:"table",props:{tables:{},focusTable:{}},setup(i,{expose:t}){const a=d(),n=(e,s)=>{if(e===1)switch(s){case 1:return"col-start-1 row-start-1";case 2:return"col-start-1 row-start-6";case 3:return"col-start-1 row-start-11";case 4:return"col-start-1 row-start-[16]"}if(e===2)switch(s){case 1:return"col-start-2 row-start-1";case 2:return"col-start-2 row-start-6";case 3:return"col-start-2 row-start-11";case 4:return"col-start-2 row-start-[16]"}if(e===3)switch(s){case 1:return"col-start-3 row-start-1";case 2:return"col-start-3 row-start-5";case 3:return"col-start-3 row-start-9";case 4:return"col-start-3 row-start-[13]";case 5:return"col-start-3 row-start-[17]"}};return t({scrollIntoView:e=>{var s;(s=a.value)==null||s.scrollIntoView(e??{behavior:"smooth"})}}),(e,s)=>{const l=S;return p(),_("div",{ref_key:"tableChart",ref:a,class:"grid gap-2 place-content-center"},[h(l,{class:"mb-4 text-center md:hidden"}),o("div",O,[Q,o("div",{class:w(["flex flex-col justify-center items-center gap-1",{"drop-shadow-[0px_0px_5px_#FD59CF]":e.focusTable==="主桌"}])},[o("div",{class:w(["w-24 h-24 rounded-full border border-black",{"bg-pink-300/30":e.focusTable==="主桌"}])},null,2),R],2)]),o("div",W,[(p(!0),_(B,null,D(e.tables,(r,u)=>(p(),_("div",{key:u,class:w(["flex flex-col justify-center items-center gap-1",[{"drop-shadow-[0px_0px_5px_#FD59CF]":e.focusTable===r.name,"row-span-4":r.column===3,"row-span-5":r.column!==3},n(r.column,r.row)]])},[o("div",{class:w(["w-16 h-16 border border-black rounded-full",{"bg-pink-300/30":e.focusTable===r.name}])},null,2),o("p",Y,v(r.name),1)],2))),128))])],512)}}}),te=()=>F(async()=>await $({sheetId:"1J4nMChqEgfE6XgD4C-AgTsyBGGFGkrTSrrZp0q7Ppbw",range:"Seating!A2:B"})),se=()=>F(async()=>await $({sheetId:"1J4nMChqEgfE6XgD4C-AgTsyBGGFGkrTSrrZp0q7Ppbw",range:"Tables!A3:C"})),ae=L("seating",()=>{const i=d([]),t=d([]),a=async()=>{var l;const{data:e,fetch:s}=se();await s(),(l=e.value)==null||l.forEach(r=>{const[u,f,g]=r;i.value.push({name:u,row:parseInt(f),column:parseInt(g)})})},n=async()=>{var l;const{data:e,fetch:s}=te();await s(),(l=e.value)==null||l.forEach(r=>{const[u,f]=r;t.value.push({name:u,table:f})})};return{tables:i,seating:t,init:async()=>{C.start("正在擺設桌子，請稍候...");try{await a(),await n()}finally{C.stop()}}}}),ce=b({__name:"seating",setup(i){const{tables:t,seating:a,init:n}=ae(),c=d(),e=d(!1),s=d(),l=d(),r=u=>{var f;e.value=!1,c.value=a.find(g=>g.name.split(/,|，|、/).includes(u)),c.value||(e.value=!0),c.value&&((f=s.value)==null||f.scrollIntoView())};return T("seat",c),T("notFound",e),M(async()=>{!(t!=null&&t.length)&&!(a!=null&&a.length)&&await n()}),(u,f)=>{var y;const g=ee,I=H;return m(t).length?(p(),_("div",{key:0,ref_key:"page",ref:l,class:"w-full md:flex grid justify-center gap-16 grid-cols-1 px-4"},[h(g,{ref_key:"tableChart",ref:s,tables:m(t),focusTable:(y=c.value)==null?void 0:y.table},null,8,["tables","focusTable"]),h(I,{class:"row-start-1 md:row-start-auto",onClick:r})],512)):x("",!0)}}});export{ce as default};
